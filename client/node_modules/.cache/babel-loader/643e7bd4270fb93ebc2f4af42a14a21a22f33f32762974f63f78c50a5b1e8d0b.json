{"ast":null,"code":"import{useContext,useState}from\"react\";import\"./comments.scss\";import{AuthContext}from\"../../context/authContext\";import{useQuery,useMutation,useQueryClient}from\"@tanstack/react-query\";import{makeRequest}from\"../../axios\";import moment from\"moment\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Comments=_ref=>{let{postId}=_ref;const[desc,setDesc]=useState(\"\");const{currentUser}=useContext(AuthContext);const{isLoading,error,data}=useQuery([\"comments\"],()=>makeRequest.get(\"/comments?postId=\"+postId).then(res=>{return res.data;}));const queryClient=useQueryClient();const mutation=useMutation(newComment=>{return makeRequest.post(\"/comments\",newComment);},{onSuccess:()=>{// Invalidate and refetch\nqueryClient.invalidateQueries([\"comments\"]);}});const handleClick=async e=>{e.preventDefault();mutation.mutate({desc,postId});setDesc(\"\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"comments\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/upload/\"+currentUser.profilePic,alt:\"\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"write a comment\",value:desc,onChange:e=>setDesc(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClick,children:\"Send\"})]}),error?\"Something went wrong\":isLoading?\"loading\":data.map(comment=>/*#__PURE__*/_jsxs(\"div\",{className:\"comment\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/upload/\"+comment.profilePic,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsx(\"span\",{children:comment.name}),/*#__PURE__*/_jsx(\"p\",{children:comment.desc})]}),/*#__PURE__*/_jsx(\"span\",{className:\"date\",children:moment(comment.createdAt).fromNow()})]}))]});};export default Comments;","map":{"version":3,"names":["useContext","useState","AuthContext","useQuery","useMutation","useQueryClient","makeRequest","moment","jsx","_jsx","jsxs","_jsxs","Comments","_ref","postId","desc","setDesc","currentUser","isLoading","error","data","get","then","res","queryClient","mutation","newComment","post","onSuccess","invalidateQueries","handleClick","e","preventDefault","mutate","className","children","src","profilePic","alt","type","placeholder","value","onChange","target","onClick","map","comment","name","createdAt","fromNow"],"sources":["D:/AlumniNetwork/client/src/components/comments/Comments.jsx"],"sourcesContent":["import { useContext, useState } from \"react\";\r\nimport \"./comments.scss\";\r\nimport { AuthContext } from \"../../context/authContext\";\r\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { makeRequest } from \"../../axios\";\r\nimport moment from \"moment\";\r\n\r\nconst Comments = ({ postId }) => {\r\n  const [desc, setDesc] = useState(\"\");\r\n  const { currentUser } = useContext(AuthContext);\r\n\r\n  const { isLoading, error, data } = useQuery([\"comments\"], () =>\r\n    makeRequest.get(\"/comments?postId=\" + postId).then((res) => {\r\n      return res.data;\r\n    })\r\n  );\r\n\r\n  const queryClient = useQueryClient();\r\n\r\n  const mutation = useMutation(\r\n    (newComment) => {\r\n      return makeRequest.post(\"/comments\", newComment);\r\n    },\r\n    {\r\n      onSuccess: () => {\r\n        // Invalidate and refetch\r\n        queryClient.invalidateQueries([\"comments\"]);\r\n      },\r\n    }\r\n  );\r\n\r\n  const handleClick = async (e) => {\r\n    e.preventDefault();\r\n    mutation.mutate({ desc, postId });\r\n    setDesc(\"\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"comments\">\r\n      <div className=\"write\">\r\n        <img src={\"/upload/\" + currentUser.profilePic} alt=\"\" />\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"write a comment\"\r\n          value={desc}\r\n          onChange={(e) => setDesc(e.target.value)}\r\n        />\r\n        <button onClick={handleClick}>Send</button>\r\n      </div>\r\n      {error\r\n        ? \"Something went wrong\"\r\n        : isLoading\r\n        ? \"loading\"\r\n        : data.map((comment) => (\r\n            <div className=\"comment\">\r\n              <img src={\"/upload/\" + comment.profilePic} alt=\"\" />\r\n              <div className=\"info\">\r\n                <span>{comment.name}</span>\r\n                <p>{comment.desc}</p>\r\n              </div>\r\n              <span className=\"date\">\r\n                {moment(comment.createdAt).fromNow()}\r\n              </span>\r\n            </div>\r\n          ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Comments;\r\n"],"mappings":"AAAA,OAASA,UAAU,CAAEC,QAAQ,KAAQ,OAAO,CAC5C,MAAO,iBAAiB,CACxB,OAASC,WAAW,KAAQ,2BAA2B,CACvD,OAASC,QAAQ,CAAEC,WAAW,CAAEC,cAAc,KAAQ,uBAAuB,CAC7E,OAASC,WAAW,KAAQ,aAAa,CACzC,MAAO,CAAAC,MAAM,KAAM,QAAQ,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE5B,KAAM,CAAAC,QAAQ,CAAGC,IAAA,EAAgB,IAAf,CAAEC,MAAO,CAAC,CAAAD,IAAA,CAC1B,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAAEgB,WAAY,CAAC,CAAGjB,UAAU,CAACE,WAAW,CAAC,CAE/C,KAAM,CAAEgB,SAAS,CAAEC,KAAK,CAAEC,IAAK,CAAC,CAAGjB,QAAQ,CAAC,CAAC,UAAU,CAAC,CAAE,IACxDG,WAAW,CAACe,GAAG,CAAC,mBAAmB,CAAGP,MAAM,CAAC,CAACQ,IAAI,CAAEC,GAAG,EAAK,CAC1D,MAAO,CAAAA,GAAG,CAACH,IAAI,CACjB,CAAC,CACH,CAAC,CAED,KAAM,CAAAI,WAAW,CAAGnB,cAAc,CAAC,CAAC,CAEpC,KAAM,CAAAoB,QAAQ,CAAGrB,WAAW,CACzBsB,UAAU,EAAK,CACd,MAAO,CAAApB,WAAW,CAACqB,IAAI,CAAC,WAAW,CAAED,UAAU,CAAC,CAClD,CAAC,CACD,CACEE,SAAS,CAAEA,CAAA,GAAM,CACf;AACAJ,WAAW,CAACK,iBAAiB,CAAC,CAAC,UAAU,CAAC,CAAC,CAC7C,CACF,CACF,CAAC,CAED,KAAM,CAAAC,WAAW,CAAG,KAAO,CAAAC,CAAC,EAAK,CAC/BA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClBP,QAAQ,CAACQ,MAAM,CAAC,CAAElB,IAAI,CAAED,MAAO,CAAC,CAAC,CACjCE,OAAO,CAAC,EAAE,CAAC,CACb,CAAC,CAED,mBACEL,KAAA,QAAKuB,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvBxB,KAAA,QAAKuB,SAAS,CAAC,OAAO,CAAAC,QAAA,eACpB1B,IAAA,QAAK2B,GAAG,CAAE,UAAU,CAAGnB,WAAW,CAACoB,UAAW,CAACC,GAAG,CAAC,EAAE,CAAE,CAAC,cACxD7B,IAAA,UACE8B,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,iBAAiB,CAC7BC,KAAK,CAAE1B,IAAK,CACZ2B,QAAQ,CAAGX,CAAC,EAAKf,OAAO,CAACe,CAAC,CAACY,MAAM,CAACF,KAAK,CAAE,CAC1C,CAAC,cACFhC,IAAA,WAAQmC,OAAO,CAAEd,WAAY,CAAAK,QAAA,CAAC,MAAI,CAAQ,CAAC,EACxC,CAAC,CACLhB,KAAK,CACF,sBAAsB,CACtBD,SAAS,CACT,SAAS,CACTE,IAAI,CAACyB,GAAG,CAAEC,OAAO,eACfnC,KAAA,QAAKuB,SAAS,CAAC,SAAS,CAAAC,QAAA,eACtB1B,IAAA,QAAK2B,GAAG,CAAE,UAAU,CAAGU,OAAO,CAACT,UAAW,CAACC,GAAG,CAAC,EAAE,CAAE,CAAC,cACpD3B,KAAA,QAAKuB,SAAS,CAAC,MAAM,CAAAC,QAAA,eACnB1B,IAAA,SAAA0B,QAAA,CAAOW,OAAO,CAACC,IAAI,CAAO,CAAC,cAC3BtC,IAAA,MAAA0B,QAAA,CAAIW,OAAO,CAAC/B,IAAI,CAAI,CAAC,EAClB,CAAC,cACNN,IAAA,SAAMyB,SAAS,CAAC,MAAM,CAAAC,QAAA,CACnB5B,MAAM,CAACuC,OAAO,CAACE,SAAS,CAAC,CAACC,OAAO,CAAC,CAAC,CAChC,CAAC,EACJ,CACN,CAAC,EACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAArC,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}